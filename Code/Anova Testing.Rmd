```{Setup}
library(tidyverse)
library(lubridate)
library(here)
library(ggplot2)
library(ggthemes)
library(ggpubr)
library(knitr)

here()
```

```{Summary of data for each city}
summary(LasVegas)

summary(Pahrump)

summary(Phoenix)

summary(FountainHills)

summary(SanDiego)

summary(Ramona)
```

```{Fitering each data set for companion city}
#Filtering Datasets from 1980 to 2022
LasVegasMetro <- LasVegas %>%
  filter(Year >= 1972 & Year <= 2022)

PahrumpSuburban <- Pahrump %>%
  filter(Year >= 1972 & Year <= 2022)

PhoenixMetro <- Phoenix %>%
  filter(Year >= 1980 & Year <= 2022)

FountainHillsSuburban <- FountainHills %>%
  filter(Year >= 1980 & Year <= 2022)

SanDiegoMetro <- SanDiego %>%
  filter(Year >= 1998 & Year <= 2022)

RamonaSuburban <- Ramona %>%
  filter(Year >= 1998 & Year <= 2022)

```

```{r}
# Combine datasets by rows
Nevada_data <- rbind(LasVegasMetro, PahrumpSuburban)

Nevada_data <- Nevada_data %>%
  select(Location, Year, Heat_Degrees, Cool_Degrees)

# Perform ANOVA test for Heat_Degrees by Location and Year
anova_result_heat <- aov(Heat_Degrees ~ Location*Year, data = Nevada_data)

# Perform ANOVA test for Cool_Degrees by Location and Year
anova_result_cool <- aov(Cool_Degrees ~ Location*Year, data = Nevada_data)

# Summary of ANOVA results for Heat_Degrees
summary(anova_result_heat) 


# Summary of ANOVA results for Cool_Degrees
summary(anova_result_cool)

# Extract F-values using the summary function
summary_anova_heat <- summary(anova_result_heat)
summary_anova_cool <- summary(anova_result_cool)


```

```{Nevada Kable}
# Extract the aov table from the summary.aov object
anova_table <- summary(anova_result_heat)[[1]]

# Convert the ANOVA table to a data frame
anova_df <- as.data.frame(anova_table)

# Display the ANOVA table using kable
kable(anova_df, caption = "ANOVA Summary Table for Heat_Degrees")



```


```{Creating Bar plot of F-values, Nevada data}

# extracted F-values
f_values_heat <- c(803.9, 88.6, 36.4)  
f_values_cool <- c(1228.7, 153.4, 36.4)  

# Combine the F-values into a matrix
f_values_matrix <- matrix(c(f_values_heat, f_values_cool), nrow = 3, byrow = TRUE)

# Names for the bars (change or customize as needed)
bar_names <- c("Heat Values", "Cool Values")

# Assign colors to bars corresponding to each factor
colors <- c(rep("red", length(f_values_heat)), rep("blue", length(f_values_cool)))


# Check the number of names and columns in the matrix
if (length(bar_names) != ncol(f_values_matrix)) {
  stop("Incorrect number of names for the columns in the matrix.")
} else {
  # Create a bar plot with specific colors for each bar
  barplot(f_values_matrix, beside = TRUE,
          col = colors,
          names.arg = bar_names,
          main = "ANOVA F-values for Heat_Degrees and Cool_Degrees",
          ylab = "F-value")

  # Adding custom labels above the bars
  text(1:3, par("usr")[4] + 5, c("Location", "Year", "Location: Year"), srt = 0, adj = c(0, 0), xpd = TRUE)
}

```


```{Test plot}

interaction.plot(x.factor = Nevada_data$Year, 
                 trace.factor = Nevada_data$Location, 
                 response = Nevada_data$Heat_Degrees, 
                 fun = mean, 
                 type = "b",
                 xlab = "Year", 
                 ylab = "Mean Heat Degrees",
                 main = "Interaction Plot of Heat_Degrees by Location and Year")
```